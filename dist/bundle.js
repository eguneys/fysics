var Tetris=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){const r=n(2);t.exports=r.app},function(t,e,n){"use strict";n.r(e);var r={};function o(t){let e=this.data={bounds:t.bounds,touches:{}};const n=Object.values({Space:"space",ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"});this.update=t=>{n.forEach(n=>{(e[n]||0===e[n])&&(e[n]+=.01*t)})}}function i(t){const e=[],n=function(t){const e=a(t);return function(t){switch(t.code){case"Space":e("space");break;case"ArrowUp":e("up");break;case"ArrowDown":e("down");break;case"ArrowLeft":e("left");break;case"ArrowRight":e("right");break;default:return}t.preventDefault()}}(t),r=function(t){const e=s(t);return function(t){switch(t.code){case"Space":e("space");break;case"ArrowUp":e("up");break;case"ArrowDown":e("down");break;case"ArrowLeft":e("left");break;case"ArrowRight":e("right")}}}(t);return e.push(u(document,"keydown",n)),e.push(u(document,"keyup",r)),()=>{e.forEach(t=>t())}}function c(t){const e=[],n=function(t){const e=a(t),n=(n,r)=>{t.touches[r]=n,e(n)};return function(e){let r=l(e);for(let e=0;e<r.length;e++){let o=r[e];const i=h(t,o),c=o.identifier,u=f(t,i);switch(u){case"leftbottom":n("left",c);break;case"rightbottom":n("right",c);break;case"lefttop":case"righttop":n("up",c)}}}}(t),r=function(t){const e=s(t);function n(n){e(t.touches[n]),delete t.touches[n]}return function(t){let e=l(t);for(let t=0;t<e.length;t++){let r=e[t],o=r.identifier;n(o)}}}(t);return["touchstart"].forEach(t=>e.push(u(document,t,n))),["touchend"].forEach(t=>e.push(u(document,t,r))),()=>{e.forEach(t=>t())}}function u(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function a(t){return e=>{t[e]||(t[e]=0)}}function s(t){return e=>{delete t[e]}}function h(t,e){let n=e.clientX,r=e.clientY;return{x:n-t.bounds.x,y:r-t.bounds.y}}function l(t){return t.changedTouches}function f(t,e){const{width:n,height:r}=t.bounds,o=.5*n,i=.5*r;return e.x<o?e.y>i?"leftbottom":"lefttop":e.y>i?"rightbottom":"righttop"}n.r(r),n.d(r,"vec3",function(){return P}),n.d(r,"add",function(){return R}),n.d(r,"mul",function(){return U}),n.d(r,"scale",function(){return j}),n.d(r,"inverse",function(){return E}),n.d(r,"addScale",function(){return O}),n.d(r,"copy",function(){return C});const d=void 0!==window.performance?window.performance:Date,p=()=>d.now(),w=window.requestAnimationFrame;function b(t,e=60){let n=!1,r=p(),o=0,i=1e3/e,c=0;this.start=()=>n?this:(n=!0,r=p(),o=w(u),this),this.stop=()=>(n=!1,0!=o&&w.cancel(o),o=0,this);const u=()=>{o=w(u);const e=p(),n=e-r;(c+=n)>=i&&(t(n),c=0),r=e}}function v(t){const e=document.createElement("canvas");t.append(e);const n=e.clientWidth,r=e.clientHeight;this.width=e.width=n,this.height=e.height=r,this.aspect=this.width/this.height,this.canvas=e,this.bounds=e.getBoundingClientRect()}function g({canvas:t,width:e,height:n,aspect:r}){const o=t.getContext("2d");this.raw=t=>t(o)}function y(t){const{width:e,height:n,aspect:r}=t;this.data={width:e,height:n,aspect:r};const o=new g(t);this.drawRect=(t,e,n,r,i="black")=>o.raw(o=>{o.fillStyle=i,o.fillRect(t,e,n,r)}),this.clear=(t="#ccc")=>o.raw(r=>{r.clearRect(0,0,e,n),r.fillStyle=t,r.fillRect(0,0,e,n)})}const m=30;function x(t){return t[0]+"."+t[1]}function k(t,e){return[t[0]*e,t[1]*e]}(()=>{let t=[];for(let e=0;e<m;e++)t.push(e)})();const S=(()=>{let t=[];for(let e=0;e<m;e++)for(let n=0;n<30;n++)t.push([e,n]);return t})();function M(){let t={},e=0;this.walls=t,this.heroPos=[1,2];const n=(t,n)=>{for(let e=0;e<n;e++)i(0,t+e),i(m-1,t+e);e+=n},r=(t,e,n)=>{for(let r=0;r<n;r++)i(t+r,e)},o=t=>{for(let e=0;e<m;e++)i(e,t)},i=(e,n)=>{let r=x([e,n]);t[r]={}};(()=>{o(e),n(e,3);for(let t=0;t<10;t++)r(0,e,.3*m),r(m-.3*m,e,.3*m),n(e,3),r(.3*m,e,.3*m),n(e,3)})()}Math.PI;function A(t,e,n){var r=Math.max(0,Math.min(1,(n-t)/(e-t)));return r*r*(3-2*r)}function P(t,e=t,n=t){return[t,e,n]}function R(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]}function U(t,e){return[t[0]*e[0],t[1]*e[1],t[2]*e[2]]}function j(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function E(t){return j(t,-1)}function O(t,e,n){return R(t,j(e,n))}function C(t){return[t[0],t[1],t[2]]}const{vec3:T}=r;function z(t){t={pos:T(0),vel:T(0),acc:T(0),theta:T(0),vTh:T(0),friction:T(-.2),gravity:T(0,-80,0),...t};let{pos:e,vel:n,acc:r,theta:o,vTh:i,friction:c,gravity:u}=t;this.pos=({x:t=e[0],y:n=e[1],z:r=e[2]})=>{e[0]=t,e[1]=n,e[2]=r},this.force=({x:t=r[0],y:e=r[1],z:n=r[2]})=>{r[0]=t,r[1]=e,r[2]=n},this.forceY=()=>r[1],this.forceX=()=>r[0],this.gravityY=()=>u[1],this.values=(t=e,n=o)=>({x:t[0],y:t[1],z:t[2],theta:[n[0],n[1],n[2]]}),this.calculateUpdate=(t,a={})=>{const s=.01*t;let h=O(o,i,s),l=n;return l=O(l=R(l,U(l,c)),r,s),l=O(l,u,s),(a.top&&l[1]<0||a.bottom&&l[1]>0)&&(l[1]=0),(a.left&&l[0]<0||a.right&&l[0]>0)&&(l[0]=0),{theta:h,vel:l,pos:O(e,l,s)}},this.applyUpdate=t=>{o=t.theta,n=t.vel,e=t.pos},this.update=t=>{this.applyUpdate(this.calculateUpdate(t))}}function L(){let t=!1,e=0;this.running=()=>t,this.value=(t=1)=>e*t,this.start=()=>{t=!0},this.stop=()=>{e=0,t=!1},this.update=n=>{if(t){e+=.01*n}}}function _(t,e){return Object.keys(t).reduce((n,r)=>({[r]:e(r,t[r]),...n}),{})}function B(t,e,n,r=n){return{left:t,top:e,right:t+n,bottom:e+r}}const D={Blue:4278190335,SwanWhite:4294439395,CrocTooth:4291939520,SummerSky:4281642208,GreyPorc:4286873978,Pumpkin:4294932799,CelGreen:4281588146,FluRed:4294922834,Mandarin:4294947138,LuckyP:4281085012,ChileanFire:4291649843},Y=t=>{return[(16711680&t)>>>16,(65280&t)>>>8,255&t,(4278190080&t)>>>24]},$=t=>{const[e,n,r,o]=Y(t),[i,c,u]=function(t,e,n){t/=255,e/=255,n/=255;var r,o,i=Math.max(t,e,n),c=Math.min(t,e,n),u=(i+c)/2;if(i==c)r=o=0;else{var a=i-c;switch(o=u>.5?a/(2-i-c):a/(i+c),i){case t:r=(e-n)/a+(e<n?6:0);break;case e:r=(n-t)/a+2;break;case n:r=(t-e)/a+4}r/=6}return[r,o,u]}(e,n,r);return[i,c,u,o]},F=(t,e,n,r)=>{const[o,i,c]=function(t,e,n){var r,o,i;if(0==e)r=o=i=n;else{function c(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}var u=n<.5?n*(1+e):n+e-n*e,a=2*n-u;r=c(a,u,t+1/3),o=c(a,u,t),i=c(a,u,t-1/3)}return[255*r,255*o,255*i]}(t,e,n);return(([t,e,n,r])=>(r<<24>>>0|t<<16>>>0|e<<8>>>0|n)>>>0)([o,i,c,r])};function G(t=D.Blue){let[e,n,r,o]=$(t);const i=[e,n,r,o];const c=t=>(...e)=>(t(...e),this);this.reset=c(t=>{e=i[0],n=i[1],r=i[2],o=i[3]}),this.base=c(()=>{i[0]=e,i[1]=n,i[2]=r,i[3]=o}),this.hue=c(t=>e=t),this.sat=c(t=>n=t),this.lum=c(t=>r=t),this.alp=c(t=>o=t),this.rgba=()=>F(e,n,r,o),this.css=()=>(function(t,e,n,r){return`hsla(${360*t}, ${100*e}%, ${100*n}%, ${r/255})`})(e,n,r,o)}function W(t,e){const{width:n,height:r}=e.data,{tileSize:o}=t.data;let i=o,c=i;const u=new z,a=new G(D.Blue);let s,h,l;this.init=t=>{let[e,n]=k(t.heroPos,o);u.pos({x:e,y:n})},this.update=t=>{s&&u.applyUpdate(s)},this.updateCollide=(t,e)=>{s=u.calculateUpdate(t,e),h=e.top,l=e.bottom};let f,d=1,p=!1,w=0,b=new L;this.updateMovement=(t,e)=>{let n=-1*u.gravityY(),r=u.gravityY();h?p=!1:r*=.5,b.update(t),e.up&&!p?(f||h?u.force({y:2.5*n*(1-A(1,3,e.up))}):(p=!0,w=d,b.start()),f=e.up):(f=void 0,u.force({y:0*-n})),e.right?(d=1,u.force({x:-r})):e.left?(d=-1,u.force({x:r})):u.force({x:0}),b.running()&&(b.value()>.4&&b.stop(),u.force({y:n,x:w*n*3.5}))},this.dimensions=t=>{const{pos:e}=u.calculateUpdate(t),n=u.values(),r=u.values(e);return{before:B(n.x,n.y,i,c),after:B(r.x,r.y,i,c)}},this.render=()=>{let{x:t,y:n}=u.values();n=r-n-o,e.drawRect(t,n,i,c,a.css())}}function X(t,e){const{width:n,height:r}=e.data,{tileSize:o}=t.data;new G(D.Blue);let i;this.init=t=>{i=t.walls},this.update=t=>{c(t)};const c=e=>{const{after:n}=t.hero.dimensions(e);let r=_(function({left:t,right:e,top:n,bottom:r},o=40){let i=.2*o;return{left:[[t,n+i],[t,r-i]],right:[[e,n+i],[e,r-i]],top:[[t+i,n],[e-i,n]],bottom:[[t+i,r],[e-i,r]]}}(n),(t,e)=>e.map(t=>x(function(t,e){return[Math.floor(t[0]/e),Math.floor(t[1]/e)]}(t,o)))),c=_(r,(t,e)=>e.some(t=>i[t]));t.hero.updateCollide(e,c)};this.render=()=>{S.forEach(t=>{let n=x(t);if(i[n]){let[n,i]=k(t,o);i=r-i-o,e.drawRect(n,i,o,o)}})}}function q(t,e){this.data={tileSize:30};let n=new M,r=this.hero=new W(this,t),o=this.walls=new X(this,t);r.init(n),o.init(n),this.update=t=>{r.update(t),r.updateMovement(t,e.data),o.update(t)},this.render=()=>{t.clear(),o.render(),r.render()}}function H(t,e){const n=new v(t),r=new o(n);i(r.data),c(r.data);const u=new q(new y(n),r);return new b(t=>{r.update(t),u.update(t),u.render()},60).start(),{}}n.d(e,"app",function(){return H})}]);